---
title: C陷阱与缺陷 - ch06
time: 2017-08-23
tags: [c]
layout: post
categories: posts
---

# 第6章 预处理器

## 6.1 不能忽视宏定义中的空格

``` c
#define f (x) ((x)-1)
```
实际意义是`f代表 (x) ((x)-1)`

## 6.2 宏并不是函数

因为宏从表面上看其行为与函数非常相似, 程序员有时会禁不住把两者视为完全等同. 因此, 我们常常可以看到类似这下面的写法:
``` c
#define abs(x) ( ((x)>=0) ? (x) : -(x) )
```
或者
``` c
#define max(a,b) ((a)>(b)?(a):(b))
```

注意宏定义中出现的所有这些括号, 它们的作用是预防引起与优先级有关的问题. 我们最好`在宏定义中把每个参数都用括号括起来`, 同样, `整个结果表达式也应该用括号括起来`, 以防止当宏用一个更大一些的表达式中可能出现的问题

即时宏定义中的各个参数与整个结果表达式都被括号括起来, 也仍然还可能有其他问题存在
